<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistema de Barbería</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/views/dashboard/styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-cut me-2"></i>
                <span>Barber Dashboard</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-section="overview">
                            <i class="fas fa-tachometer-alt me-1"></i>Resumen
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="turnos">
                            <i class="fas fa-calendar-alt me-1"></i>Turnos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="clients">
                            <i class="fas fa-users me-1"></i>Clientes
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="services">
                            <i class="fas fa-concierge-bell me-1"></i>Servicios
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="schedule">
                            <i class="fas fa-clock me-1"></i>Horarios
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="reports">
                            <i class="fas fa-chart-bar me-1"></i>Reportes
                        </a>
                    </li>

                    <li class="nav-item admin-only" style="display: none;">
                        <a class="nav-link" href="#" data-section="admin">
                            <i class="fas fa-user-shield me-1"></i>Administración
                        </a>
                    </li>
                </ul>
                
                <div class="navbar-nav">
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>
                            <span id="userName">Usuario</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" id="logoutBtn">
                                <i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión
                            </a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container-fluid">
            <!-- Overview Section -->
            <section id="overview" class="dashboard-section active">
                <div class="row mb-4">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-tachometer-alt me-2"></i>
                            Resumen del Día
                        </h1>
                        <p class="text-muted">Bienvenido de vuelta, <span id="welcomeUserName">Usuario</span></p>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-primary">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="todayTurnos">0</h3>
                                <p>Turnos Hoy</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="completedTurnosMain">0</h3>
                                <p>Completadas</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="pendingTurnos">0</h3>
                                <p>Turnos Pendientes</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card position-relative">
                            <button class="btn btn-link btn-sm position-absolute top-0 end-0 text-info toggle-btn" id="toggleIngresosBtn" title="Ocultar ingresos">
                                <i class="fas fa-eye-slash"></i>
                            </button>
                            <div class="stat-icon bg-info">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="todayRevenueMain">$0</h3>
                                <p>Ingresos Hoy</p>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Próximos Turnos -->
                <div class="row">
                    <div class="col-lg-8 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-calendar-alt me-2"></i>
                                    Próximos Turnos
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="upcomingTurnosList" class="turnos-list">
                                    <div class="text-center text-muted py-4">
                                        <i class="fas fa-calendar-times fa-3x mb-3"></i>
                                        <p>No hay turnos programados</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-chart-pie me-2"></i>
                                    Servicios Populares
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="popularServicesList">
                                    <div class="text-center text-muted py-4">
                                        <i class="fas fa-chart-bar fa-3x mb-3"></i>
                                        <p>No hay datos disponibles</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Other Sections (Placeholder) -->
            <section id="turnos" class="dashboard-section">
                <div class="row">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-calendar-alt me-2"></i>
                            Gestión de Turnos
                        </h1>
                        <p class="text-muted">Administra todos los turnos y reservas</p>
                    </div>
                </div>

                <!-- Filtros y búsqueda -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label for="filterEstado" class="form-label">Estado:</label>
                                        <select id="filterEstado" class="form-select">
                                            <option value="">Todos</option>
                                            <option value="reservado">Reservado</option>
                                            <option value="confirmado">Confirmado</option>
                                            <option value="en_proceso">En Proceso</option>
                                            <option value="completado">Completado</option>
                                            <option value="cancelado">Cancelado</option>
                                            <option value="no_show">No Show</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="filterFecha" class="form-label">Fecha:</label>
                                        <input type="date" id="filterFecha" class="form-control">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="searchCliente" class="form-label">Buscar Cliente:</label>
                                        <input type="text" id="searchCliente" class="form-control" placeholder="Nombre, teléfono...">
                                    </div>
                                    <div class="col-md-3 mb-3 d-flex align-items-end">
                                        <button class="btn btn-secondary me-2" id="btnLimpiarFiltros">
                                            <i class="fas fa-times me-1"></i>Limpiar
                                        </button>
                                        <button class="btn btn-primary" id="btnNuevaCita">
                                            <i class="fas fa-plus me-1"></i>Nuevo Turno
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Estadísticas rápidas -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-primary">
                                <i class="fas fa-calendar-plus"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalReservadas">0</h3>
                                <p>Reservadas</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalConfirmadas">0</h3>
                                <p>Confirmadas</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-info">
                                <i class="fas fa-check-double"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalCompletadas">0</h3>
                                <p>Completadas</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-danger">
                                <i class="fas fa-times-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalCanceladas">0</h3>
                                <p>Canceladas</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Panel de Auto-Completado -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card border-warning auto-complete-panel">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-robot me-2"></i>
                                    Sistema de Auto-Completado
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="status-indicator active me-3"></div>
                                            <div>
                                                <h6 class="mb-0">Estado</h6>
                                                <small class="text-muted">Activo</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="text-info me-3">
                                                <i class="fas fa-clock fa-2x"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Última Ejecución</h6>
                                                <small class="text-muted" id="lastExecution">--</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="text-success me-3">
                                                <i class="fas fa-check-circle fa-2x"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Próxima Ejecución</h6>
                                                <small class="text-muted" id="nextExecution">--</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="text-warning me-3">
                                                <i class="fas fa-cog fa-2x"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Frecuencia</h6>
                                                <small class="text-muted">Cada 5 minutos</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Estadísticas y Acciones -->
                                <div class="row mt-3">
                                    <div class="col-md-4 mb-3">
                                        <div class="card border-left-warning shadow h-100 py-2">
                                            <div class="card-body">
                                                <div class="row no-gutters align-items-center">
                                                    <div class="col mr-2">
                                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                                            Pendientes de Auto-Completar
                                                        </div>
                                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="pendingAutoComplete">0</div>
                                                    </div>
                                                    <div class="col-auto">
                                                        <i class="fas fa-clock fa-2x text-gray-300"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="card border-left-success shadow h-100 py-2">
                                            <div class="card-body">
                                                <div class="row no-gutters align-items-center">
                                                    <div class="col mr-2">
                                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                                            Auto-Completados Hoy
                                                        </div>
                                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="autoCompletedToday">0</div>
                                                    </div>
                                                    <div class="col-auto">
                                                        <i class="fas fa-robot fa-2x text-gray-300"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="d-flex align-items-end h-100">
                                            <button class="btn btn-warning btn-lg w-100" id="btnAutoComplete">
                                                <i class="fas fa-robot me-2"></i>
                                                Ejecutar Auto-Completado
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Lista de Turnos Pendientes -->
                                <div class="row mt-3" id="pendingTurnosSection" style="display: none;">
                                    <div class="col-12">
                                        <h6 class="text-warning mb-3">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            Turnos Pendientes de Auto-Completado
                                        </h6>
                                        <div class="table-responsive">
                                            <table class="table table-sm table-warning" id="pendingTurnosTable">
                                                <thead>
                                                    <tr>
                                                        <th>Cliente</th>
                                                        <th>Servicio</th>
                                                        <th>Fecha</th>
                                                        <th>Hora Fin</th>
                                                        <th>Estado</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="pendingTurnosBody">
                                                    <!-- Se llenará dinámicamente -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de turnos -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-list me-2"></i>
                                    Lista de Turnos
                                </h5>
                                <div>
                                    <button class="btn btn-outline-secondary btn-sm me-2" id="btnExportar">
                                        <i class="fas fa-download me-1"></i>Exportar
                                    </button>
                                    <button class="btn btn-outline-primary btn-sm" id="btnRefresh">
                                        <i class="fas fa-sync-alt me-1"></i>Actualizar
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="tablaTurnos">
                                        <thead>
                                            <tr>
                                                <th>Cliente</th>
                                                <th>Servicio</th>
                                                <th>Fecha</th>
                                                <th>Hora</th>
                                                <th>Estado</th>
                                                <th>Precio</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="turnosTableBody">
                                            <!-- Los datos se cargarán dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Paginación -->
                                <div class="d-flex justify-content-center mt-3" id="pagination">
                                    <!-- La paginación se generará dinámicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="clients" class="dashboard-section">
                <div class="row">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-users me-2"></i>
                            Gestión de Clientes
                        </h1>
                        <p class="text-muted">Administra tu base de clientes</p>
                    </div>
                </div>

                <!-- Estadísticas de Clientes -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-primary">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalClients">0</h3>
                                <p>Total Clientes</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-success">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="newClients">0</h3>
                                <p>Nuevos (30 días)</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-warning">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="frequentClients">0</h3>
                                <p>Clientes Frecuentes</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-info">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="activeClients">0</h3>
                                <p>Clientes Activos</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Barra de Acciones -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-6 mb-3 mb-md-0">
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="clientSearchInput" placeholder="Buscar clientes...">
                                            <button class="btn btn-outline-primary" type="button" id="clientSearchBtn">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6 text-md-end">
                                        <button class="btn btn-primary" id="addClientBtn">
                                            <i class="fas fa-plus me-2"></i>Nuevo Cliente
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lista de Clientes -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-list me-2"></i>
                                    Lista de Clientes
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="clientsTable">
                                        <thead>
                                            <tr>
                                                <th>Nombre</th>
                                                <th>Teléfono</th>
                                                <th>Email</th>
                                                <th>Total Turnos</th>
                                                <th>Último Turno</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="clientsTableBody">
                                            <tr>
                                                <td colspan="7" class="text-center text-muted py-4">
                                                    <i class="fas fa-users fa-3x mb-3"></i>
                                                    <p>No hay clientes registrados</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Paginación -->
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div class="text-muted">
                                        Mostrando <span id="clientsShowing">0</span> de <span id="clientsTotal">0</span> clientes
                                    </div>
                                    <nav aria-label="Paginación de clientes">
                                        <ul class="pagination pagination-sm mb-0" id="clientsPagination">
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="services" class="dashboard-section">
                <div class="row">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-concierge-bell me-2"></i>
                            Gestión de Servicios
                        </h1>
                        <p class="text-muted">Administra tus servicios y precios</p>
                    </div>
                </div>

                <!-- Estadísticas de Servicios -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-primary">
                                <i class="fas fa-concierge-bell"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalServices">0</h3>
                                <p>Total Servicios</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="activeServices">0</h3>
                                <p>Servicios Activos</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-info">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalBookings">0</h3>
                                <p>Total Reservas</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon bg-warning">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalRevenue">$0</h3>
                                <p>Ingresos Totales</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filtros y búsqueda -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label for="filterServiceEstado" class="form-label">Estado:</label>
                                        <select id="filterServiceEstado" class="form-select">
                                            <option value="">Todos</option>
                                            <option value="activo">Activo</option>
                                            <option value="inactivo">Inactivo</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="searchService" class="form-label">Buscar Servicio:</label>
                                        <input type="text" id="searchService" class="form-control" placeholder="Nombre del servicio...">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="filterServicePrice" class="form-label">Rango de Precio:</label>
                                        <select id="filterServicePrice" class="form-select">
                                            <option value="">Todos</option>
                                            <option value="0-25">$0 - $25</option>
                                            <option value="25-50">$25 - $50</option>
                                            <option value="50-100">$50 - $100</option>
                                            <option value="100+">$100+</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 mb-3 d-flex align-items-end">
                                        <button class="btn btn-secondary me-2" id="btnLimpiarFiltrosServices">
                                            <i class="fas fa-times me-1"></i>Limpiar
                                        </button>
                                        <button class="btn btn-primary" id="btnNuevoServicio">
                                            <i class="fas fa-plus me-1"></i>Nuevo Servicio
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de servicios -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-list me-2"></i>
                                    Lista de Servicios
                                </h5>
                                <div>
                                    <button class="btn btn-outline-secondary btn-sm me-2" id="btnExportarServices">
                                        <i class="fas fa-download me-1"></i>Exportar
                                    </button>
                                    <button class="btn btn-outline-primary btn-sm" id="btnRefreshServices">
                                        <i class="fas fa-sync-alt me-1"></i>Actualizar
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover services-table" id="tablaServicios">
                                        <thead>
                                            <tr>
                                                <th>Servicio</th>
                                                <th>Descripción</th>
                                                <th>Precio</th>
                                                <th>Duración</th>
                                                <th>Reservas</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="serviciosTableBody">
                                            <!-- Los datos se cargarán dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Paginación -->
                                <div class="d-flex justify-content-center mt-3" id="paginationServices">
                                    <!-- La paginación se generará dinámicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            

            <section id="schedule" class="dashboard-section">
                <div class="row">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-clock me-2"></i>
                            Gestión de Horarios
                        </h1>
                        <p class="text-muted">Configura tus horarios de trabajo y días especiales</p>
                    </div>
                </div>

                <!-- Configuración General -->
                <div class="row mb-4">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-cog me-2"></i>
                                    Configuración General
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="configForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="bufferTime" class="form-label">Buffer entre turnos</label>
                                            <select class="form-select" id="bufferTime">
                                                <option value="0">Sin buffer</option>
                                                <option value="5" selected>5 minutos</option>
                                                <option value="10">10 minutos</option>
                                                <option value="15">15 minutos</option>
                                            </select>
                                            <small class="form-text text-muted">
                                                <i class="fas fa-clock me-1"></i>
                                                Tiempo de limpieza/preparación entre turnos
                                            </small>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="anticipacionReserva" class="form-label">Anticipación mínima</label>
                                            <select class="form-select" id="anticipacionReserva">
                                                <option value="60">1 hora antes</option>
                                                <option value="120">2 horas antes</option>
                                                <option value="240">4 horas antes</option>
                                                <option value="1440" selected>1 día antes</option>
                                                <option value="2880">2 días antes</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="maxReservasDia" class="form-label">Máximo reservas por día</label>
                                            <input type="number" class="form-control" id="maxReservasDia" value="20" min="1" max="50">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="permitirReservasMismoDia" checked>
                                                <label class="form-check-label" for="permitirReservasMismoDia">
                                                    Permitir reservas el mismo día
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-2"></i>Guardar Configuración
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-calendar-week me-2"></i>
                                    Vista Semanal
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="weekly-overview">
                                    <div class="week-day" data-day="lunes">
                                        <div class="day-header">
                                            <span class="day-name">Lunes</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="martes">
                                        <div class="day-header">
                                            <span class="day-name">Martes</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="miercoles">
                                        <div class="day-header">
                                            <span class="day-name">Miércoles</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="jueves">
                                        <div class="day-header">
                                            <span class="day-name">Jueves</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="viernes">
                                        <div class="day-header">
                                            <span class="day-name">Viernes</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="sabado">
                                        <div class="day-header">
                                            <span class="day-name">Sábado</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                    <div class="week-day" data-day="domingo">
                                        <div class="day-header">
                                            <span class="day-name">Domingo</span>
                                            <div class="day-status"></div>
                                        </div>
                                        <div class="day-hours">
                                            <span class="hours">Cargando...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Horarios Detallados -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-calendar-alt me-2"></i>
                                    Horarios Detallados
                                </h5>
                                <button class="btn btn-success btn-sm" id="addScheduleBtn">
                                    <i class="fas fa-plus me-2"></i>Agregar Horario
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Día</th>
                                                <th>Hora Inicio</th>
                                                <th>Hora Fin</th>
                                                <th>Pausa</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="scheduleTableBody">
                                            <!-- Los datos se cargarán dinámicamente desde JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Días Especiales -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-calendar-day me-2"></i>
                                    Días Especiales
                                </h5>
                                <button class="btn btn-warning btn-sm" id="addSpecialDayBtn">
                                    <i class="fas fa-plus me-2"></i>Agregar Día Especial
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="row" id="specialDaysContainer">
                                    <!-- Los días especiales se cargarán dinámicamente desde JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

                        <section id="reports" class="dashboard-section">
                <div class="row mb-4">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-chart-bar me-2"></i>
                            Reportes y Análisis
                        </h1>
                        <p class="text-muted">Analiza el rendimiento de tu negocio por períodos</p>
                    </div>
                </div>

                <!-- Filtros de Período -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card shadow">
                            <div class="card-body">
                                <div class="row align-items-end">
                                    <div class="col-md-3">
                                        <label for="reportPeriod" class="form-label fw-bold">Período</label>
                                        <select id="reportPeriod" class="form-select">
                                            <option value="today">📅 Hoy</option>
                                            <option value="yesterday">📆 Ayer</option>
                                            <option value="week">📊 Esta Semana</option>
                                            <option value="month" selected>📈 Este Mes</option>
                                            <option value="quarter">📉 Este Trimestre</option>
                                            <option value="year">🎯 Este Año</option>
                                            <option value="custom">⚙️ Personalizado</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3" id="customDateRange" style="display: none;">
                                        <label for="startDate" class="form-label fw-bold">Fecha Inicio</label>
                                        <input type="date" id="startDate" class="form-control">
                                    </div>
                                    <div class="col-md-3" id="customDateRangeEnd" style="display: none;">
                                        <label for="endDate" class="form-label fw-bold">Fecha Fin</label>
                                        <input type="date" id="endDate" class="form-control">
                                    </div>
                                    <div class="col-md-3">
                                        <button id="generateReport" class="btn btn-primary w-100">
                                            <i class="fas fa-sync-alt me-2"></i>Actualizar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Métricas Principales -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                            Turnos Completados
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="completedTurnos">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Ingresos Totales
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalIngresos">$0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                            Ingresos por Hora
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="ingresosPorHora">$0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-clock fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                            Promedio por Turno
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="promedioTurno">$0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-chart-line fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Métricas de Eficiencia -->
                <div class="row mb-4">
                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Tasa de Completado
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="tasaCompletado">0%</div>
                                        <div class="text-xs text-muted">Turnos completados vs reservados</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-percentage fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="card border-left-danger shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">
                                            Tasa de Cancelación
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="tasaCancelacion">0%</div>
                                        <div class="text-xs text-muted">Turnos cancelados vs total</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-times-circle fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                            Turnos Pendientes
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="pendingTurnos">0</div>
                                        <div class="text-xs text-muted">Reservas confirmadas</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-hourglass-half fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gráficos Comparativos -->
                <div class="row mb-4">
                    <!-- Gráfico de Ingresos por Período -->
                    <div class="col-xl-8 col-lg-7">
                        <div class="card shadow">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-line me-2"></i>
                                    Ingresos por Período
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-area" style="height: 300px;">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gráfico de Turnos por Período -->
                    <div class="col-xl-4 col-lg-5">
                        <div class="card shadow">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-pie me-2"></i>
                                    Distribución de Turnos
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-area" style="height: 300px;">
                                    <canvas id="turnosChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gráfico de Evolución Semanal -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card shadow">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-bar me-2"></i>
                                    Evolución Semanal - Últimas 8 Semanas
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-area" style="height: 400px;">
                                    <canvas id="weeklyChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Clientes y Servicios -->
                <div class="row mb-4">
                    <!-- Top Clientes -->
                    <div class="col-xl-6 col-lg-6">
                        <div class="card shadow">
                            <div class="card-header bg-secondary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-trophy me-2"></i>
                                    Top 5 Clientes del Período
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>#</th>
                                                <th>Cliente</th>
                                                <th>Turnos</th>
                                                <th>Total Gastado</th>
                                            </tr>
                                        </thead>
                                        <tbody id="topClientsTable">
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin me-2"></i>
                                                    Cargando clientes...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Servicios Más Populares -->
                    <div class="col-xl-6 col-lg-6">
                        <div class="card shadow">
                            <div class="card-header bg-warning text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-star me-2"></i>
                                    Servicios Más Populares del Período
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>#</th>
                                                <th>Servicio</th>
                                                <th>Turnos</th>
                                                <th>Ingresos</th>
                                            </tr>
                                        </thead>
                                        <tbody id="topServicesTable">
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin me-2"></i>
                                                    Cargando servicios...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección de Administración (solo para admins) -->
            <section id="admin" class="dashboard-section admin-only" style="display: none;">
                <div class="row mb-4">
                    <div class="col-12">
                        <h1 class="section-title">
                            <i class="fas fa-user-shield me-2"></i>
                            Panel de Administración
                        </h1>
                        <p class="text-muted">Gestiona barberos y configuración del sistema</p>
                    </div>
                </div>

                <!-- Estadísticas de Empleados -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                            Total Barberos
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalEmployees">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-users fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Barberos Activos
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="activeEmployees">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-check fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                            Barberos Inactivos
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="inactiveEmployees">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-times fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                            Administradores
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="adminCount">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-shield fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gestión de Empleados -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-users me-2"></i>
                                    Gestión de Barberos
                                </h5>
                                <button class="btn btn-primary btn-sm" id="refreshEmployeesBtn">
                                    <i class="fas fa-sync-alt me-1"></i>
                                    Actualizar
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="employeesTable">
                                        <thead>
                                            <tr>
                                                <th>Nombre</th>
                                                <th>Email</th>
                                                <th>Barbería</th>
                                                <th>Rol</th>
                                                <th>Estado</th>
                                                <th>Último Acceso</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="employeesTableBody">
                                            <tr>
                                                <td colspan="7" class="text-center">Cargando barberos...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Configuración del Sistema -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-cogs me-2"></i>
                                    Configuración del Sistema
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Códigos de Registro</h6>
                                        <div class="mb-3">
                                            <label class="form-label">Código para Barberos</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="barberCode" readonly>
                                                <button class="btn btn-outline-secondary" type="button" id="copyBarberCode">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Código para Administradores</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="adminCode" readonly>
                                                <button class="btn btn-outline-secondary" type="button" id="copyAdminCode">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Acciones del Sistema</h6>
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-outline-primary" id="backupSystemBtn">
                                                <i class="fas fa-download me-2"></i>
                                                Crear Backup
                                            </button>
                                            <button class="btn btn-outline-warning" id="clearLogsBtn">
                                                <i class="fas fa-trash me-2"></i>
                                                Limpiar Logs
                                            </button>
                                            <button class="btn btn-outline-info" id="systemInfoBtn">
                                                <i class="fas fa-info-circle me-2"></i>
                                                Información del Sistema
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>



            <!-- Panel de Insights del Negocio -->
            <div class="row mb-4">
                <div class="col-12">
                    <div id="businessInsights">
                        <!-- Los insights se cargarán dinámicamente aquí -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin fa-2x"></i>
            <p>Cargando...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1050;">
        <!-- Los toasts se crearán dinámicamente aquí -->
    </div>

    <!-- Modal para información del sistema -->
    <div class="modal fade" id="systemInfoModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-info-circle me-2"></i>
                        Información del Sistema
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="systemInfoModalBody">
                    <!-- Contenido dinámico -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para nueva/editar cita -->
    <div class="modal fade" id="modalCita" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Nueva Cita</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formCita">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="clienteSelect" class="form-label">Cliente *</label>
                                <select id="clienteSelect" class="form-select" required>
                                    <option value="">Seleccionar cliente...</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="servicioSelect" class="form-label">Servicio *</label>
                                <select id="servicioSelect" class="form-select" required>
                                    <option value="">Seleccionar servicio...</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="fechaCita" class="form-label">Fecha *</label>
                                <input type="date" id="fechaCita" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="horaCita" class="form-label">Hora *</label>
                                <select id="horaCita" class="form-select" required>
                                    <option value="">Selecciona una fecha primero...</option>
                                </select>
                                <div id="slotsMessage" class="form-text mt-1"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="estadoCita" class="form-label">Estado</label>
                                <select id="estadoCita" class="form-select">
                                    <option value="reservado">Reservado</option>
                                    <option value="confirmado">Confirmado</option>
                                    <option value="en_proceso">En Proceso</option>
                                    <option value="completado">Completado</option>
                                    <option value="cancelado">Cancelado</option>
                                    <option value="no_show">No Show</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="precioCita" class="form-label">Precio Final</label>
                                <input type="number" id="precioCita" class="form-control" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="notasCita" class="form-label">Notas</label>
                            <textarea id="notasCita" class="form-control" rows="3" placeholder="Notas adicionales..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarCita">Guardar Cita</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmación -->
    <div class="modal fade" id="modalConfirmacion" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirmar Acción</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="mensajeConfirmacion">¿Estás seguro de que deseas realizar esta acción?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmarAccion">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Agregar/Editar Cliente -->
    <div class="modal fade" id="clientModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="clientModalTitle">
                        <i class="fas fa-user-plus me-2"></i>Nuevo Cliente
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="clientForm">
                        <input type="hidden" id="clientId">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="clientNombre" class="form-label">Nombre *</label>
                                <input type="text" class="form-control" id="clientNombre" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="clientApellido" class="form-label">Apellido *</label>
                                <input type="text" class="form-control" id="clientApellido" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="clientTelefono" class="form-label">Teléfono *</label>
                                <input type="tel" class="form-control" id="clientTelefono" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="clientEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="clientEmail">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="clientFechaNacimiento" class="form-label">Fecha de Nacimiento</label>
                                <input type="date" class="form-control" id="clientFechaNacimiento">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="clientEstado" class="form-label">Estado</label>
                                <select class="form-select" id="clientEstado">
                                    <option value="activo">Activo</option>
                                    <option value="inactivo">Inactivo</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="clientNotas" class="form-label">Notas</label>
                            <textarea class="form-control" id="clientNotas" rows="3" maxlength="500"></textarea>
                            <div class="form-text">
                                <span id="notasCount">0</span>/500 caracteres
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="saveClientBtn">
                        <i class="fas fa-save me-2"></i>Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Ver Cliente -->
    <div class="modal fade" id="viewClientModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user me-2"></i>Detalles del Cliente
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Información Personal</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Nombre:</strong></td>
                                    <td id="viewClientNombre"></td>
                                </tr>
                                <tr>
                                    <td><strong>Teléfono:</strong></td>
                                    <td id="viewClientTelefono"></td>
                                </tr>
                                <tr>
                                    <td><strong>Email:</strong></td>
                                    <td id="viewClientEmail"></td>
                                </tr>
                                <tr>
                                    <td><strong>Fecha Nacimiento:</strong></td>
                                    <td id="viewClientFechaNacimiento"></td>
                                </tr>
                                <tr>
                                    <td><strong>Notas:</strong></td>
                                    <td id="viewClientNotas"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6>Estadísticas</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Total Turnos:</strong></td>
                                    <td id="viewClientTotalCitas"></td>
                                </tr>
                                <tr>
                                    <td><strong>Último Turno:</strong></td>
                                    <td id="viewClientUltimaCita"></td>
                                </tr>
                                <tr>
                                    <td><strong>Estado:</strong></td>
                                    <td id="viewClientEstado"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                                                            <h6>Historial de Turnos</h6>
                        <div class="table-responsive">
                            <table class="table table-sm" id="clientHistoryTable">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Hora</th>
                                        <th>Servicio</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="clientHistoryTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="editClientBtn">
                        <i class="fas fa-edit me-2"></i>Editar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Agregar/Editar Servicio -->
    <div class="modal fade" id="serviceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="serviceModalTitle">
                        <i class="fas fa-concierge-bell me-2"></i>Nuevo Servicio
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="serviceForm">
                        <input type="hidden" id="serviceId">
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="serviceNombre" class="form-label">Nombre del Servicio *</label>
                                <input type="text" class="form-control" id="serviceNombre" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="serviceEstado" class="form-label">Estado</label>
                                <select class="form-select" id="serviceEstado">
                                    <option value="activo">Activo</option>
                                    <option value="inactivo">Inactivo</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="servicePrecio" class="form-label">Precio *</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="servicePrecio" step="0.01" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="serviceDuracion" class="form-label">Duración del Servicio *</label>
                                <select class="form-select" id="serviceDuracion" required>
                                    <option value="15">15 minutos</option>
                                    <option value="20">20 minutos</option>
                                    <option value="30" selected>30 minutos</option>
                                    <option value="45">45 minutos</option>
                                    <option value="60">1 hora</option>
                                    <option value="75">1 hora 15 min</option>
                                    <option value="90">1 hora 30 min</option>
                                    <option value="120">2 horas</option>
                                </select>
                                <div class="form-text">
                                    <i class="fas fa-clock me-1"></i>
                                    Tiempo que toma realizar este servicio
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="servicePrecioAnterior" class="form-label">Precio Anterior</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="servicePrecioAnterior" step="0.01" min="0">
                                </div>
                                <div class="form-text">Opcional: para mostrar descuentos</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Información</label>
                                <div class="duration-suggestions">
                                    <small class="text-muted">
                                        <strong>Precio:</strong> Costo del servicio<br>
                                        <strong>Precio Anterior:</strong> Para mostrar descuentos<br>
                                        <strong>Descripción:</strong> Detalles del servicio
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="serviceDescripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="serviceDescripcion" rows="3" maxlength="500" placeholder="Describe el servicio, incluye detalles, productos utilizados, etc."></textarea>
                            <div class="form-text">
                                <span id="serviceDescripcionCount">0</span>/500 caracteres
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="saveServiceBtn">
                        <i class="fas fa-save me-2"></i>Guardar Servicio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Ver Servicio -->
    <div class="modal fade" id="viewServiceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-concierge-bell me-2"></i>Detalles del Servicio
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Información del Servicio</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Nombre:</strong></td>
                                    <td id="viewServiceNombre"></td>
                                </tr>
                                <tr>
                                    <td><strong>Precio:</strong></td>
                                    <td id="viewServicePrecio"></td>
                                </tr>
                                <tr>
                                    <td><strong>Duración:</strong></td>
                                    <td id="viewServiceDuracion">Configurada en Horarios</td>
                                </tr>
                                <tr>
                                    <td><strong>Estado:</strong></td>
                                    <td id="viewServiceEstado"></td>
                                </tr>
                                <tr>
                                    <td><strong>Descripción:</strong></td>
                                    <td id="viewServiceDescripcion"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6>Estadísticas</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Total Reservas:</strong></td>
                                    <td id="viewServiceTotalReservas"></td>
                                </tr>
                                <tr>
                                    <td><strong>Reservas Completadas:</strong></td>
                                    <td id="viewServiceReservasCompletadas"></td>
                                </tr>
                                <tr>
                                    <td><strong>Ingresos Generados:</strong></td>
                                    <td id="viewServiceIngresos"></td>
                                </tr>
                                <tr>
                                    <td><strong>Última Reserva:</strong></td>
                                    <td id="viewServiceUltimaReserva"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Historial de Precios</h6>
                        <div class="table-responsive">
                            <table class="table table-sm price-history-table" id="servicePriceHistoryTable">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Precio Anterior</th>
                                        <th>Precio Nuevo</th>
                                        <th>Cambio</th>
                                    </tr>
                                </thead>
                                <tbody id="servicePriceHistoryTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="editServiceBtn">
                        <i class="fas fa-edit me-2"></i>Editar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="text-center">
            <div class="loading-spinner mb-3"></div>
            <h5 class="text-primary">Cargando reporte...</h5>
            <p class="text-muted">Por favor espera mientras procesamos los datos</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JS -->
    <script src="/views/dashboard/utils.js"></script>
    <script src="/views/dashboard/script.js"></script>
    <script src="/views/dashboard/schedule.js"></script>
    <script src="/views/dashboard/reports.js"></script>
    <script src="/views/dashboard/turnos.js"></script>
    <script src="/views/dashboard/services.js"></script>
    <script src="/views/dashboard/admin.js"></script>
    <script src="/views/dashboard/auto-complete.js"></script>

        <style>
            /* Estilos para la tarjeta de ingresos */
            .badge.status-reserved {
                background-color: #007bff;
            }
            
            .badge.status-confirmed {
                background-color: #28a745;
            }
            
            .badge.status-completed {
                background-color: #17a2b8;
            }
            
            .badge.status-cancelled {
                background-color: #dc3545;
            }
            
            /* Estilos para el botón toggle fijo */
            .toggle-btn {
                z-index: 10;
                padding: 8px 12px;
                border-radius: 0 0.375rem 0 0.375rem;
                background-color: rgba(255, 255, 255, 0.9);
                backdrop-filter: blur(5px);
                border: none;
                transition: all 0.3s ease;
            }
            
            .toggle-btn:hover {
                transform: scale(1.1);
                background-color: rgba(255, 255, 255, 1);
                text-decoration: none;
            }
            
            .toggle-btn:focus {
                box-shadow: none;
                outline: none;
            }
            
            /* Transición suave para mostrar/ocultar */
            #todayRevenue {
                transition: all 0.3s ease;
            }
            
            /* Asegurar que el contenido no se superponga con el botón */
            .stat-card .stat-content {
                padding-top: 5px;
            }

            /* Estilos para el sistema de auto-completado */
            .status-indicator {
                width: 12px;
                height: 12px;
                border-radius: 50%;
                display: inline-block;
            }

            .status-indicator.active {
                background-color: #28a745;
                box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2);
            }

            .status-indicator.inactive {
                background-color: #dc3545;
                box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
            }

            .turno-item {
                transition: all 0.3s ease;
                border-left: 4px solid #ffc107 !important;
            }

            .turno-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            }

            .log-entry {
                transition: all 0.2s ease;
            }

            .log-entry:hover {
                background-color: rgba(0, 0, 0, 0.02);
            }

            .status-badge {
                padding: 0.25rem 0.5rem;
                border-radius: 0.375rem;
                font-size: 0.75rem;
                font-weight: 600;
            }

            /* Animaciones para los botones de acción */
            #runAutoCompleteBtn, #refreshStatsBtn {
                transition: all 0.3s ease;
            }

            #runAutoCompleteBtn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
            }

            #refreshStatsBtn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
            }

            /* Estilos para las métricas de auto-completado */
            .border-left-warning {
                border-left: 4px solid #ffc107 !important;
            }

            .border-left-success {
                border-left: 4px solid #28a745 !important;
            }

            .border-left-info {
                border-left: 4px solid #17a2b8 !important;
            }
        </style>
          </body>
  </html> 